<!DOCTYPE html><html lang="en-US" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Java Multithreading - Deadlock" /><meta name="author" content="Gaurav Kumar" /><meta property="og:locale" content="en_US" /><meta name="description" content="This following post is based on the Udemy Course: Java Multithreading" /><meta property="og:description" content="This following post is based on the Udemy Course: Java Multithreading" /><link rel="canonical" href="https://gkgaurav31.github.io/posts/java-multithreading-deadlock/" /><meta property="og:url" content="https://gkgaurav31.github.io/posts/java-multithreading-deadlock/" /><meta property="og:site_name" content="Gauravâ€™s GitHub Page" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-07-14T00:19:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Java Multithreading - Deadlock" /><meta name="twitter:site" content="@gkgaurav31" /><meta name="twitter:creator" content="@Gaurav Kumar" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Gaurav Kumar"},"dateModified":"2023-07-14T00:19:00+05:30","datePublished":"2023-07-14T00:19:00+05:30","description":"This following post is based on the Udemy Course: Java Multithreading","headline":"Java Multithreading - Deadlock","mainEntityOfPage":{"@type":"WebPage","@id":"https://gkgaurav31.github.io/posts/java-multithreading-deadlock/"},"url":"https://gkgaurav31.github.io/posts/java-multithreading-deadlock/"}</script><title>Java Multithreading - Deadlock | Gaurav's GitHub Page</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous" /><link rel="dns-prefetch" href="https://fonts.gstatic.com" /><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials" /><link rel="dns-prefetch" href="https://www.google-analytics.com" /><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous" /><link rel="dns-prefetch" href="https://www.googletagmanager.com" /><link rel="preconnect" href="https://cdn.jsdelivr.net" /><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous" /><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js" ></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-BM99475K5Q"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-BM99475K5Q'); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/freak.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Gaurav's GitHub Page</a></div><div class="site-subtitle font-italic">A place to code</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a><li class="nav-item"> <a href="/coffee/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>BUY ME A COFFEE</span> </a><li class="nav-item"> <a href="/gratitude/" class="nav-link"> <i class="fa-fw fas fa-heart ml-xl-3 mr-xl-3 unloaded"></i> <span>THANK YOU!</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/gkgaurav31" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/gkgaurav31" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['gkgaurav31','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Java Multithreading - Deadlock</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Java Multithreading - Deadlock</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Gaurav Kumar </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Jul 14, 2023, 12:19 AM +0530" prep="on" > Jul 14, 2023 <i class="unloaded">2023-07-14T00:19:00+05:30</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1760 words">9 min</span></div></div><div class="post-content"><p>This following post is based on the Udemy Course: <a href="https://www.udemy.com/course/java-multithreading/learn/lecture/107238#content">Java Multithreading</a></p><hr /><h2 id="deadlock">DEADLOCK</h2><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>   Process 1           Process 2
+-----------------+  +-----------------+
|    Resource A   |  |    Resource B   |
+-----------------+  +-----------------+
|   Request B     |  |   Request A     |
|    (waiting)    |  |    (waiting)    |
+-----------------+  +-----------------+
</pre></table></code></div></div><p>In the above image, there are two processes, Process 1 and Process 2, represented by the boxes. Each process requires access to two resources, Resource A and Resource B, represented by the labeled boxes.</p><p>Process 1 is currently holding Resource A but needs Resource B to continue its execution. However, Process 2 is holding Resource B and needs Resource A to proceed further. As a result, both processes are waiting for the resources that are held by the other process, creating a deadlock.</p><h2 id="example-using-code">EXAMPLE USING CODE</h2><h3 id="accountjava">Account.java</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.threads</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Account</span> <span class="o">{</span>

 <span class="kd">private</span> <span class="kt">int</span> <span class="n">balance</span> <span class="o">=</span> <span class="mi">10000</span><span class="o">;</span>
 
 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deposit</span><span class="o">(</span><span class="kt">int</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">balance</span> <span class="o">+=</span> <span class="n">amount</span><span class="o">;</span>
 <span class="o">}</span>
 
 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">withdraw</span><span class="o">(</span><span class="kt">int</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">balance</span> <span class="o">-=</span> <span class="n">amount</span><span class="o">;</span>
 <span class="o">}</span>
 
 <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getBalance</span><span class="o">()</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">balance</span><span class="o">;</span>
 <span class="o">}</span>
 
 <span class="c1">//static method to transfer the given amount from account1 to account 2</span>
 <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">transfer</span><span class="o">(</span><span class="nc">Account</span> <span class="n">account1</span><span class="o">,</span> <span class="nc">Account</span> <span class="n">account2</span><span class="o">,</span> <span class="kt">int</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">account1</span><span class="o">.</span><span class="na">withdraw</span><span class="o">(</span><span class="n">amount</span><span class="o">);</span>
  <span class="n">account2</span><span class="o">.</span><span class="na">deposit</span><span class="o">(</span><span class="n">amount</span><span class="o">);</span>
 <span class="o">}</span>
 
<span class="o">}</span>
</pre></table></code></div></div><h3 id="appjava">App.java</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.threads</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
 
 <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
  
  <span class="nc">Runner</span> <span class="n">runner</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Runner</span><span class="o">();</span>
  
  <span class="c1">//thread1 -&gt; will run firstThread() method is Runner</span>
  <span class="nc">Thread</span> <span class="n">t1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">(</span><span class="k">new</span> <span class="nc">Runnable</span><span class="o">()</span> <span class="o">{</span>
   
   <span class="nd">@Override</span>
   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">runner</span><span class="o">.</span><span class="na">firstThread</span><span class="o">();</span>
   <span class="o">}</span>
  <span class="o">});</span>
  
  <span class="c1">//thread2 -&gt; will run secondThread() method is Runner</span>
  <span class="nc">Thread</span> <span class="n">t2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">(</span><span class="k">new</span> <span class="nc">Runnable</span><span class="o">()</span> <span class="o">{</span>
   
   <span class="nd">@Override</span>
   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">runner</span><span class="o">.</span><span class="na">secondThread</span><span class="o">();</span>
   <span class="o">}</span>
  <span class="o">});</span>
  
  <span class="n">t1</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
  <span class="n">t2</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
  
  <span class="n">t1</span><span class="o">.</span><span class="na">join</span><span class="o">();</span>
  <span class="n">t2</span><span class="o">.</span><span class="na">join</span><span class="o">();</span>
  
  <span class="n">runner</span><span class="o">.</span><span class="na">finished</span><span class="o">();</span>
  
 <span class="o">}</span>
 
<span class="o">}</span>
</pre></table></code></div></div><h3 id="runnerjava">Runner.java</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.threads</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.locks.Lock</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.locks.ReentrantLock</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Runner</span> <span class="o">{</span>

 <span class="nc">Account</span> <span class="n">account1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Account</span><span class="o">();</span>
 <span class="nc">Account</span> <span class="n">account2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Account</span><span class="o">();</span>
 
 <span class="nc">Lock</span> <span class="n">lock1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ReentrantLock</span><span class="o">();</span>
 <span class="nc">Lock</span> <span class="n">lock2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ReentrantLock</span><span class="o">();</span>
 
 <span class="c1">//gets both the locks and transfers the amount from account 1 to account 2</span>
 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">firstThread</span><span class="o">()</span> <span class="o">{</span>
  
  <span class="n">lock1</span><span class="o">.</span><span class="na">lock</span><span class="o">();</span>
  <span class="n">lock2</span><span class="o">.</span><span class="na">lock</span><span class="o">();</span>
  
  <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">1000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
   <span class="nc">Account</span><span class="o">.</span><span class="na">transfer</span><span class="o">(</span><span class="n">account1</span><span class="o">,</span> <span class="n">account2</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">100</span><span class="o">));</span>
  <span class="o">}</span>
  
  <span class="n">lock1</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>
  <span class="n">lock2</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>
  
 <span class="o">}</span>
 
 <span class="c1">//gets both the locks and transfers the amount from account 2 to account 1</span>
 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">secondThread</span><span class="o">()</span> <span class="o">{</span>
  
  <span class="n">lock1</span><span class="o">.</span><span class="na">lock</span><span class="o">();</span>
  <span class="n">lock2</span><span class="o">.</span><span class="na">lock</span><span class="o">();</span>
  
  <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">1000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
   <span class="nc">Account</span><span class="o">.</span><span class="na">transfer</span><span class="o">(</span><span class="n">account2</span><span class="o">,</span> <span class="n">account1</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">100</span><span class="o">));</span>
  <span class="o">}</span>
  
  <span class="n">lock1</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>
  <span class="n">lock2</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>
  
 <span class="o">}</span>
 
 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">finished</span><span class="o">()</span> <span class="o">{</span>
  <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Total amount: "</span> <span class="o">+</span> <span class="o">(</span><span class="n">account1</span><span class="o">.</span><span class="na">getBalance</span><span class="o">()</span> <span class="o">+</span> <span class="n">account2</span><span class="o">.</span><span class="na">getBalance</span><span class="o">()));</span>
 <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>This will work as expected an show the output as - <code class="language-plaintext highlighter-rouge">Total amount: 20000</code></p><h2 id="deadlock-code">DEADLOCK CODE</h2><p>If we change the sequence in which the locks are obtained, it can lead to deadlock.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">secondThread</span><span class="o">()</span> <span class="o">{</span>
  
  <span class="c1">//changed the sequence of getting locks</span>
  <span class="c1">//now it's possible that thread1 got lock1 and thread2 got lock2. Then, thread1 is waiting for lock2 and thread2 is waiting for lock1. Due to this both the threads will be blocked.</span>
  <span class="n">lock2</span><span class="o">.</span><span class="na">lock</span><span class="o">();</span>
  <span class="n">lock1</span><span class="o">.</span><span class="na">lock</span><span class="o">();</span>
  
  <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">1000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
   <span class="nc">Account</span><span class="o">.</span><span class="na">transfer</span><span class="o">(</span><span class="n">account2</span><span class="o">,</span> <span class="n">account1</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">100</span><span class="o">));</span>
  <span class="o">}</span>
  
  <span class="n">lock1</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>
  <span class="n">lock2</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>
  
 <span class="o">}</span>
</pre></table></code></div></div><h2 id="thread-dump-during-deadlock">THREAD DUMP (DURING DEADLOCK)</h2><blockquote><p>Command: jcmd PID Thread.print</p></blockquote><p>In the thread dump, we can see that the deadlock was detected!</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
</pre><td class="rouge-code"><pre>20588:
2023-07-14 00:30:44
Full thread dump OpenJDK 64-Bit Server VM (11.0.15+10-LTS mixed mode):

Threads class SMR info:
_java_thread_list=0x00000271c16947b0, length=12, elements={
0x000002719151a000, 0x00000271c1255000, 0x00000271c1256800, 0x00000271c12df000,
0x00000271c12e0000, 0x00000271c12e2800, 0x00000271c12e5000, 0x00000271c1310800,
0x00000271c1321000, 0x00000271c148b800, 0x00000271c178a800, 0x00000271c178b000
}

"main" #1 prio=5 os_prio=0 cpu=46.88ms elapsed=29.55s tid=0x000002719151a000 nid=0x7fb8 in Object.wait()  [0x000000813dafe000]
   java.lang.Thread.State: WAITING (on object monitor)
 at java.lang.Object.wait(java.base@11.0.15/Native Method)
 - waiting on &lt;0x00000006222668b0&gt; (a java.lang.Thread)
 at java.lang.Thread.join(java.base@11.0.15/Thread.java:1300)
 - waiting to re-lock in wait() &lt;0x00000006222668b0&gt; (a java.lang.Thread)
 at java.lang.Thread.join(java.base@11.0.15/Thread.java:1375)
 at com.threads.App.main(thread101/App.java:28)

"Reference Handler" #2 daemon prio=10 os_prio=2 cpu=0.00ms elapsed=29.53s tid=0x00000271c1255000 nid=0x5938 waiting on condition  [0x000000813e1fe000]
   java.lang.Thread.State: RUNNABLE
 at java.lang.ref.Reference.waitForReferencePendingList(java.base@11.0.15/Native Method)
 at java.lang.ref.Reference.processPendingReferences(java.base@11.0.15/Reference.java:241)
 at java.lang.ref.Reference$ReferenceHandler.run(java.base@11.0.15/Reference.java:213)

"Finalizer" #3 daemon prio=8 os_prio=1 cpu=0.00ms elapsed=29.53s tid=0x00000271c1256800 nid=0x1428 in Object.wait()  [0x000000813e2fe000]
   java.lang.Thread.State: WAITING (on object monitor)
 at java.lang.Object.wait(java.base@11.0.15/Native Method)
 - waiting on &lt;0x0000000622408f98&gt; (a java.lang.ref.ReferenceQueue$Lock)
 at java.lang.ref.ReferenceQueue.remove(java.base@11.0.15/ReferenceQueue.java:155)
 - waiting to re-lock in wait() &lt;0x0000000622408f98&gt; (a java.lang.ref.ReferenceQueue$Lock)
 at java.lang.ref.ReferenceQueue.remove(java.base@11.0.15/ReferenceQueue.java:176)
 at java.lang.ref.Finalizer$FinalizerThread.run(java.base@11.0.15/Finalizer.java:170)

"Signal Dispatcher" #4 daemon prio=9 os_prio=2 cpu=0.00ms elapsed=29.52s tid=0x00000271c12df000 nid=0x4d4c runnable  [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

"Attach Listener" #5 daemon prio=5 os_prio=2 cpu=0.00ms elapsed=29.52s tid=0x00000271c12e0000 nid=0x3e74 waiting on condition  [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

"Service Thread" #6 daemon prio=9 os_prio=0 cpu=0.00ms elapsed=29.52s tid=0x00000271c12e2800 nid=0x6a0c runnable  [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

"C2 CompilerThread0" #7 daemon prio=9 os_prio=2 cpu=0.00ms elapsed=29.52s tid=0x00000271c12e5000 nid=0x7760 waiting on condition  [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE
   No compile task

"C1 CompilerThread0" #10 daemon prio=9 os_prio=2 cpu=0.00ms elapsed=29.52s tid=0x00000271c1310800 nid=0x75ec waiting on condition  [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE
   No compile task

"Sweeper thread" #11 daemon prio=9 os_prio=2 cpu=0.00ms elapsed=29.52s tid=0x00000271c1321000 nid=0x4470 runnable  [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

"Common-Cleaner" #12 daemon prio=8 os_prio=1 cpu=0.00ms elapsed=29.48s tid=0x00000271c148b800 nid=0x7cb0 in Object.wait()  [0x000000813e9ff000]
   java.lang.Thread.State: TIMED_WAITING (on object monitor)
 at java.lang.Object.wait(java.base@11.0.15/Native Method)
 - waiting on &lt;0x0000000622574190&gt; (a java.lang.ref.ReferenceQueue$Lock)
 at java.lang.ref.ReferenceQueue.remove(java.base@11.0.15/ReferenceQueue.java:155)
 - waiting to re-lock in wait() &lt;0x0000000622574190&gt; (a java.lang.ref.ReferenceQueue$Lock)
 at jdk.internal.ref.CleanerImpl.run(java.base@11.0.15/CleanerImpl.java:148)
 at java.lang.Thread.run(java.base@11.0.15/Thread.java:829)
 at jdk.internal.misc.InnocuousThread.run(java.base@11.0.15/InnocuousThread.java:161)

"Thread-0" #13 prio=5 os_prio=0 cpu=0.00ms elapsed=29.42s tid=0x00000271c178a800 nid=0x7860 waiting on condition  [0x000000813ebfe000]
   java.lang.Thread.State: WAITING (parking)
 at jdk.internal.misc.Unsafe.park(java.base@11.0.15/Native Method)
 - parking to wait for  &lt;0x0000000622266780&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)
 at java.util.concurrent.locks.LockSupport.park(java.base@11.0.15/LockSupport.java:194)
 at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(java.base@11.0.15/AbstractQueuedSynchronizer.java:885)
 at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(java.base@11.0.15/AbstractQueuedSynchronizer.java:917)
 at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(java.base@11.0.15/AbstractQueuedSynchronizer.java:1240)
 at java.util.concurrent.locks.ReentrantLock.lock(java.base@11.0.15/ReentrantLock.java:267)
 at com.threads.Runner.firstThread(thread101/Runner.java:19)
 at com.threads.App$1.run(thread101/App.java:13)
 at java.lang.Thread.run(java.base@11.0.15/Thread.java:829)

"Thread-1" #14 prio=5 os_prio=0 cpu=0.00ms elapsed=29.42s tid=0x00000271c178b000 nid=0x5c3c waiting on condition  [0x000000813ecfe000]
   java.lang.Thread.State: WAITING (parking)
 at jdk.internal.misc.Unsafe.park(java.base@11.0.15/Native Method)
 - parking to wait for  &lt;0x0000000622266750&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)
 at java.util.concurrent.locks.LockSupport.park(java.base@11.0.15/LockSupport.java:194)
 at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(java.base@11.0.15/AbstractQueuedSynchronizer.java:885)
 at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(java.base@11.0.15/AbstractQueuedSynchronizer.java:917)
 at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(java.base@11.0.15/AbstractQueuedSynchronizer.java:1240)
 at java.util.concurrent.locks.ReentrantLock.lock(java.base@11.0.15/ReentrantLock.java:267)
 at com.threads.Runner.secondThread(thread101/Runner.java:33)
 at com.threads.App$2.run(thread101/App.java:21)
 at java.lang.Thread.run(java.base@11.0.15/Thread.java:829)

"VM Thread" os_prio=2 cpu=0.00ms elapsed=29.53s tid=0x00000271c1254800 nid=0x1f74 runnable  

"GC Thread#0" os_prio=2 cpu=0.00ms elapsed=29.55s tid=0x0000027191531000 nid=0x2bcc runnable  

"G1 Main Marker" os_prio=2 cpu=0.00ms elapsed=29.55s tid=0x00000271915b4800 nid=0x81a0 runnable  

"G1 Conc#0" os_prio=2 cpu=0.00ms elapsed=29.55s tid=0x00000271915b6800 nid=0x7b70 runnable  

"G1 Refine#0" os_prio=2 cpu=0.00ms elapsed=29.54s tid=0x00000271c08be000 nid=0x1020 runnable  

"G1 Young RemSet Sampling" os_prio=2 cpu=0.00ms elapsed=29.54s tid=0x00000271c08c1000 nid=0x3b64 runnable  
"VM Periodic Task Thread" os_prio=2 cpu=0.00ms elapsed=29.43s tid=0x00000271c153e800 nid=0x49a8 waiting on condition  

JNI global refs: 8, weak refs: 0


Found one Java-level deadlock:
=============================
"Thread-0":
  waiting for ownable synchronizer 0x0000000622266780, (a java.util.concurrent.locks.ReentrantLock$NonfairSync),
  which is held by "Thread-1"
"Thread-1":
  waiting for ownable synchronizer 0x0000000622266750, (a java.util.concurrent.locks.ReentrantLock$NonfairSync),
  which is held by "Thread-0"

Java stack information for the threads listed above:
===================================================
"Thread-0":
 at jdk.internal.misc.Unsafe.park(java.base@11.0.15/Native Method)
 - parking to wait for  &lt;0x0000000622266780&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)
 at java.util.concurrent.locks.LockSupport.park(java.base@11.0.15/LockSupport.java:194)
 at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(java.base@11.0.15/AbstractQueuedSynchronizer.java:885)
 at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(java.base@11.0.15/AbstractQueuedSynchronizer.java:917)
 at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(java.base@11.0.15/AbstractQueuedSynchronizer.java:1240)
 at java.util.concurrent.locks.ReentrantLock.lock(java.base@11.0.15/ReentrantLock.java:267)
 at com.threads.Runner.firstThread(thread101/Runner.java:19)
 at com.threads.App$1.run(thread101/App.java:13)
 at java.lang.Thread.run(java.base@11.0.15/Thread.java:829)
"Thread-1":
 at jdk.internal.misc.Unsafe.park(java.base@11.0.15/Native Method)
 - parking to wait for  &lt;0x0000000622266750&gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)
 at java.util.concurrent.locks.LockSupport.park(java.base@11.0.15/LockSupport.java:194)
 at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(java.base@11.0.15/AbstractQueuedSynchronizer.java:885)
 at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(java.base@11.0.15/AbstractQueuedSynchronizer.java:917)
 at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(java.base@11.0.15/AbstractQueuedSynchronizer.java:1240)
 at java.util.concurrent.locks.ReentrantLock.lock(java.base@11.0.15/ReentrantLock.java:267)
 at com.threads.Runner.secondThread(thread101/Runner.java:33)
 at com.threads.App$2.run(thread101/App.java:21)
 at java.lang.Thread.run(java.base@11.0.15/Thread.java:829)

Found 1 deadlock.
</pre></table></code></div></div><h2 id="fixing-the-deadlock">FIXING THE DEADLOCK</h2><p>The idea is to ensure that either both the locks are acquired or none of them.</p><p>With the locks being released in the finally blocks, it helps prevent deadlocks from occurring. If one thread acquires lock1 and the other thread acquires lock2, and they both reach the finally block, each thread will release the lock it acquired. This ensures that even if one thread holds one lock and is waiting for the other, both locks will eventually be released, allowing progress to be made.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.threads</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.locks.Lock</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.locks.ReentrantLock</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Runner</span> <span class="o">{</span>

 <span class="nc">Account</span> <span class="n">account1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Account</span><span class="o">();</span>
 <span class="nc">Account</span> <span class="n">account2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Account</span><span class="o">();</span>

 <span class="nc">Lock</span> <span class="n">lock1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ReentrantLock</span><span class="o">();</span>
 <span class="nc">Lock</span> <span class="n">lock2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ReentrantLock</span><span class="o">();</span>
 
 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">acquireLocks</span><span class="o">(</span><span class="nc">Lock</span> <span class="n">lock1</span><span class="o">,</span> <span class="nc">Lock</span> <span class="n">lock2</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
  
  <span class="c1">//both the threads will keep running this loop while trying to acquire both the locks</span>
  <span class="c1">//if one of the threads get lock1, and other gets the other lock2, then the finally block will be executed for those threads</span>
  <span class="c1">//in finally, they will "release" the locks that they had acquired, thereby avoiding any chance of deadlock</span>
  <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>

   <span class="kt">boolean</span> <span class="n">isFirstLocked</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
   <span class="kt">boolean</span> <span class="n">isSecondLocked</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

   <span class="k">try</span> <span class="o">{</span>

    <span class="c1">//Acquires the lock if it is available and returns immediately with the value true.</span>
    <span class="c1">//If the lock is not available then this method will return immediately with the value false. </span>
    <span class="n">isFirstLocked</span> <span class="o">=</span> <span class="n">lock1</span><span class="o">.</span><span class="na">tryLock</span><span class="o">();</span>
    <span class="n">isSecondLocked</span> <span class="o">=</span> <span class="n">lock2</span><span class="o">.</span><span class="na">tryLock</span><span class="o">();</span>

   <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">isFirstLocked</span> <span class="o">&amp;&amp;</span> <span class="n">isSecondLocked</span><span class="o">)</span> <span class="o">{</span>
     <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">isFirstLocked</span><span class="o">)</span>
     <span class="n">lock1</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">isSecondLocked</span><span class="o">)</span>
     <span class="n">lock2</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>

   <span class="o">}</span>

   <span class="c1">// try again for some time</span>
   <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

  <span class="o">}</span>

 <span class="o">}</span>

 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">firstThread</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>

  <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
   
   <span class="c1">//thread1 will keep trying to acquire both the locks</span>
   <span class="c1">//this will only move forward after it gets both the locks</span>
   <span class="n">acquireLocks</span><span class="o">(</span><span class="n">lock2</span><span class="o">,</span> <span class="n">lock1</span><span class="o">);</span>

   <span class="k">try</span> <span class="o">{</span>
    <span class="nc">Account</span><span class="o">.</span><span class="na">transfer</span><span class="o">(</span><span class="n">account1</span><span class="o">,</span> <span class="n">account2</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">100</span><span class="o">));</span>
   <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
    <span class="n">lock1</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>
    <span class="n">lock2</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>

   <span class="o">}</span>

  <span class="o">}</span>

 <span class="o">}</span>

 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">secondThread</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>

  <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
   
   <span class="c1">//thread2 will keep trying to acquire both the locks</span>
   <span class="c1">//this will only move forward after it gets both the locks</span>
   <span class="n">acquireLocks</span><span class="o">(</span><span class="n">lock2</span><span class="o">,</span> <span class="n">lock1</span><span class="o">);</span>

   <span class="k">try</span> <span class="o">{</span>
    <span class="nc">Account</span><span class="o">.</span><span class="na">transfer</span><span class="o">(</span><span class="n">account2</span><span class="o">,</span> <span class="n">account1</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">100</span><span class="o">));</span>
   <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
    <span class="n">lock1</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>
    <span class="n">lock2</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>
   <span class="o">}</span>

  <span class="o">}</span>

 <span class="o">}</span>

 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">finished</span><span class="o">()</span> <span class="o">{</span>
  <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Total amount: "</span> <span class="o">+</span> <span class="o">(</span><span class="n">account1</span><span class="o">.</span><span class="na">getBalance</span><span class="o">()</span> <span class="o">+</span> <span class="n">account2</span><span class="o">.</span><span class="na">getBalance</span><span class="o">()));</span>
 <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/multithreading/'>multithreading</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/java/" class="post-tag no-text-decoration" >java</a> <a href="/tags/multithreading/" class="post-tag no-text-decoration" >multithreading</a> <a href="/tags/theory/" class="post-tag no-text-decoration" >theory</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Java Multithreading - Deadlock - Gaurav's GitHub Page&url=https://gkgaurav31.github.io/posts/java-multithreading-deadlock/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Java Multithreading - Deadlock - Gaurav's GitHub Page&u=https://gkgaurav31.github.io/posts/java-multithreading-deadlock/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Java Multithreading - Deadlock - Gaurav's GitHub Page&url=https://gkgaurav31.github.io/posts/java-multithreading-deadlock/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://gkgaurav31.github.io/posts/java-multithreading-deadlock/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/amount-of-time-for-binary-tree-to-be-infected/">Amount of Time for Binary Tree to Be Infected</a><li><a href="/posts/cross-site-scripting-xss/">Cross-Site Scripting (XSS)</a><li><a href="/posts/find-the-celebrity/">Find the Celebrity</a><li><a href="/posts/find-the-element-that-appears-once-in-sorted-array/">Find the element that appears once in sorted array (geeksforgeeks - SDE Sheet)</a><li><a href="/posts/find-all-pairs-with-a-given-sum-geeksforgeeks-sde-sheet/">Find all pairs with a given sum (geeksforgeeks - SDE Sheet)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/geeksforgeeks/">geeksforgeeks</a> <a class="post-tag" href="/tags/important/">important</a> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/sde-sheet/">sde-sheet</a> <a class="post-tag" href="/tags/arrays/">arrays</a> <a class="post-tag" href="/tags/neetcode150/">neetcode150</a> <a class="post-tag" href="/tags/binarytree/">binarytree</a> <a class="post-tag" href="/tags/dynamic-programming/">dynamic_programming</a> <a class="post-tag" href="/tags/interviewbit/">interviewbit</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/java-multithreading-starting-java-threads/"><div class="card-body"> <span class="timeago small" > Jul 2, 2023 <i class="unloaded">2023-07-02T23:51:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Java Multithreading - Starting Java Threads</h3><div class="text-muted small"><p> This following post is based on the Udemy Course: Java Multithreading We can create threads either by extending the Thread class or by implementing the Runnable interface. Here is an example of ...</p></div></div></a></div><div class="card"> <a href="/posts/java-multithreading-basic-thread-synchronization/"><div class="card-body"> <span class="timeago small" > Jul 3, 2023 <i class="unloaded">2023-07-03T20:39:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Java Multithreading - Basic Thread Synchronization</h3><div class="text-muted small"><p> This following post is based on the Udemy Course: Java Multithreading When data is shared between multiple threads, a common issue arises with data caching. In the following example, there is a ...</p></div></div></a></div><div class="card"> <a href="/posts/java-multithreading-the-synchronized-keyword/"><div class="card-body"> <span class="timeago small" > Jul 4, 2023 <i class="unloaded">2023-07-04T20:35:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Java Multithreading - The Synchronized Keyword</h3><div class="text-muted small"><p> This following post is based on the Udemy Course: Java Multithreading In the following code, the result of sysout(count) will be 0. This is because, even though we have started the two threads t...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/design-pattern-factory/" class="btn btn-outline-primary" prompt="Older"><p>Design Pattern: Factory</p></a> <a href="/posts/java-multithreading-semaphores/" class="btn btn-outline-primary" prompt="Newer"><p>Java Multithreading - Semaphores</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2025 <a href="https://twitter.com/gkgaurav31">Gaurav Kumar</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/geeksforgeeks/">geeksforgeeks</a> <a class="post-tag" href="/tags/important/">important</a> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/sde-sheet/">sde sheet</a> <a class="post-tag" href="/tags/arrays/">arrays</a> <a class="post-tag" href="/tags/neetcode150/">neetcode150</a> <a class="post-tag" href="/tags/binarytree/">binarytree</a> <a class="post-tag" href="/tags/dynamic-programming/">dynamic_programming</a> <a class="post-tag" href="/tags/interviewbit/">interviewbit</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://gkgaurav31.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
