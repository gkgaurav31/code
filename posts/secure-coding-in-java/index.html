<!DOCTYPE html><html lang="en-US" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Secure Coding in Java - OWASP TOP 10" /><meta name="author" content="Gaurav Kumar" /><meta property="og:locale" content="en_US" /><meta name="description" content="OWASP TOP 10 VULNERABILITIES" /><meta property="og:description" content="OWASP TOP 10 VULNERABILITIES" /><link rel="canonical" href="https://gkgaurav31.github.io/posts/secure-coding-in-java/" /><meta property="og:url" content="https://gkgaurav31.github.io/posts/secure-coding-in-java/" /><meta property="og:site_name" content="Gaurav’s GitHub Page" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-11-11T17:20:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Secure Coding in Java - OWASP TOP 10" /><meta name="twitter:site" content="@gkgaurav31" /><meta name="twitter:creator" content="@Gaurav Kumar" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Gaurav Kumar"},"dateModified":"2024-11-11T17:20:00+05:30","datePublished":"2024-11-11T17:20:00+05:30","description":"OWASP TOP 10 VULNERABILITIES","headline":"Secure Coding in Java - OWASP TOP 10","mainEntityOfPage":{"@type":"WebPage","@id":"https://gkgaurav31.github.io/posts/secure-coding-in-java/"},"url":"https://gkgaurav31.github.io/posts/secure-coding-in-java/"}</script><title>Secure Coding in Java - OWASP TOP 10 | Gaurav's GitHub Page</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous" /><link rel="dns-prefetch" href="https://fonts.gstatic.com" /><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials" /><link rel="dns-prefetch" href="https://www.google-analytics.com" /><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous" /><link rel="dns-prefetch" href="https://www.googletagmanager.com" /><link rel="preconnect" href="https://cdn.jsdelivr.net" /><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous" /><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js" ></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-BM99475K5Q"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-BM99475K5Q'); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/freak.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Gaurav's GitHub Page</a></div><div class="site-subtitle font-italic">A place to code</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a><li class="nav-item"> <a href="/coffee/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>BUY ME A COFFEE</span> </a><li class="nav-item"> <a href="/gratitude/" class="nav-link"> <i class="fa-fw fas fa-heart ml-xl-3 mr-xl-3 unloaded"></i> <span>THANK YOU!</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/gkgaurav31" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/gkgaurav31" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['gkgaurav31','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Secure Coding in Java - OWASP TOP 10</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Secure Coding in Java - OWASP TOP 10</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Gaurav Kumar </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Nov 11, 2024, 5:20 PM +0530" prep="on" > Nov 11, 2024 <i class="unloaded">2024-11-11T17:20:00+05:30</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1212 words">6 min</span></div></div><div class="post-content"><h2 id="owasp-top-10-vulnerabilities">OWASP TOP 10 VULNERABILITIES</h2><h3 id="broken-accesss-control">BROKEN ACCESSS CONTROL</h3><p>Broken access control allows users to access resources or functionalities they shouldn’t. This happens when the application fails to check user permissions.</p><p>Example: A non-admin user can access admin pages by simply changing the URL.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">viewAdminPage</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="nc">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
    <span class="c1">// No validation of user role</span>
    <span class="n">response</span><span class="o">.</span><span class="na">getWriter</span><span class="o">().</span><span class="na">println</span><span class="o">(</span><span class="s">"Welcome to the admin page!"</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Without checking the user’s role, anyone with a session can access this page.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">viewAdminPage</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="nc">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="s">"admin"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">session</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">"role"</span><span class="o">)))</span> <span class="o">{</span>
        <span class="n">response</span><span class="o">.</span><span class="na">getWriter</span><span class="o">().</span><span class="na">println</span><span class="o">(</span><span class="s">"Welcome to the admin page!"</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="n">response</span><span class="o">.</span><span class="na">sendError</span><span class="o">(</span><span class="nc">HttpServletResponse</span><span class="o">.</span><span class="na">SC_FORBIDDEN</span><span class="o">,</span> <span class="s">"Access denied"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Best Practices:</p><ul><li>Implement role-based access control.<li>Ensure all restricted resources check user permissions.<li>Use server-side access checks, not just client-side.</ul><h3 id="cryptographic-failures">CRYPTOGRAPHIC FAILURES</h3><p>Cryptographic failures happen when sensitive data is not protected properly. This includes unencrypted data transmission or storing passwords in plaintext.</p><p>Example: Storing passwords in plain text allows anyone with access to the database to see them.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">storePassword</span><span class="o">(</span><span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Storing plain text password</span>
    <span class="n">database</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="s">"password"</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Storing passwords in plain text exposes users to risks if the database is compromised.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="nc">String</span> <span class="nf">hashPassword</span><span class="o">(</span><span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">NoSuchAlgorithmException</span> <span class="o">{</span>
    <span class="nc">MessageDigest</span> <span class="n">md</span> <span class="o">=</span> <span class="nc">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"SHA-256"</span><span class="o">);</span>
    <span class="kt">byte</span><span class="o">[]</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="na">digest</span><span class="o">(</span><span class="n">password</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
    <span class="k">return</span> <span class="nc">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">().</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">hash</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Best Practices:</p><ul><li>Use strong algorithms like AES for data encryption.<li>Never store passwords in plain text; use salted hashing (like bcrypt).<li>Avoid using deprecated or weak algorithms.</ul><h3 id="injection">INJECTION</h3><p>Injection vulnerabilities occur when untrusted data is executed as part of a query or command. SQL injection is common, where an attacker can manipulate database queries.</p><p>Example:</p><p>An attacker can inject SQL code like <code class="language-plaintext highlighter-rouge">"' OR '1'='1"</code> into username to bypass authentication.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">authenticate</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">,</span> <span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">"SELECT * FROM users WHERE username='"</span> <span class="o">+</span> <span class="n">username</span> <span class="o">+</span> <span class="s">"' AND password='"</span> <span class="o">+</span> <span class="n">password</span> <span class="o">+</span> <span class="s">"'"</span><span class="o">;</span>
    <span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
    <span class="nc">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Avoid constructing queries by concatenating strings with user inputs.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">authenticate</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">,</span> <span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">"SELECT * FROM users WHERE username=? AND password=?"</span><span class="o">;</span>
    <span class="nc">PreparedStatement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>
    <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">username</span><span class="o">);</span>
    <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
    <span class="nc">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
    <span class="k">return</span> <span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Best Practices:</p><ul><li>Use prepared statements or parameterized queries.<li>Validate and sanitize all user inputs.<li>Avoid constructing queries by concatenating strings with user inputs.</ul><h3 id="insecure-design">INSECURE DESIGN</h3><p>This occurs when an application is designed without considering security, such as lack of validation, logging, or rate limiting.</p><p>Example:</p><p>Allowing any file to be uploaded without checking file type or content.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">uploadFile</span><span class="o">(</span><span class="nc">MultipartFile</span> <span class="n">file</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="c1">// No validation of file type or size</span>
    <span class="nc">Files</span><span class="o">.</span><span class="na">copy</span><span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">(),</span> <span class="nc">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/uploads/"</span> <span class="o">+</span> <span class="n">file</span><span class="o">.</span><span class="na">getOriginalFilename</span><span class="o">()));</span>
<span class="o">}</span>
</pre></table></code></div></div><p>An attacker could upload malicious files, leading to server compromise.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">uploadFile</span><span class="o">(</span><span class="nc">MultipartFile</span> <span class="n">file</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="na">getOriginalFilename</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">filename</span><span class="o">.</span><span class="na">endsWith</span><span class="o">(</span><span class="s">".jpg"</span><span class="o">)</span> <span class="o">||</span> <span class="n">filename</span><span class="o">.</span><span class="na">endsWith</span><span class="o">(</span><span class="s">".png"</span><span class="o">))</span> <span class="o">{</span>
        <span class="nc">Files</span><span class="o">.</span><span class="na">copy</span><span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">(),</span> <span class="nc">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/uploads/"</span> <span class="o">+</span> <span class="n">filename</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IOException</span><span class="o">(</span><span class="s">"Invalid file type"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Best Practices:</p><ul><li>Validate file type, size, and content before processing uploads.<li>Apply rate limiting and input validation throughout the application.<li>Regularly review and test your application’s design for security gaps.</ul><h3 id="security-misconfiguration">SECURITY MISCONFIGURATION</h3><p>Security misconfigurations arise when the system is improperly configured, such as leaving debug mode enabled in production.</p><p>Example:</p><p>Showing detailed error messages to users.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="c1">// Potential error-causing code</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">response</span><span class="o">.</span><span class="na">getWriter</span><span class="o">().</span><span class="na">println</span><span class="o">(</span><span class="s">"Error: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>  <span class="c1">// Insecure</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Revealing error messages can expose sensitive system information to attackers.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="c1">// Potential error-causing code</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">response</span><span class="o">.</span><span class="na">sendError</span><span class="o">(</span><span class="nc">HttpServletResponse</span><span class="o">.</span><span class="na">SC_INTERNAL_SERVER_ERROR</span><span class="o">,</span> <span class="s">"An unexpected error occurred."</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Best Practices:</p><ul><li>Disable detailed error messages in production.<li>Regularly review and update server configurations.<li>Disable unnecessary features, modules, or services.</ul><h3 id="vulnerable-and-outdated-components">VULNERABLE AND OUTDATED COMPONENTS</h3><p>Using outdated libraries or components can expose applications to known vulnerabilities.</p><p>Example:</p><p>Using an old library version without checking for security updates.</p><p>Old versions may contain known vulnerabilities that attackers can exploit.</p><p>Best Practices:</p><ul><li>Regularly update libraries and dependencies.<li>Use vulnerability scanning tools to monitor dependencies.</ul><h3 id="identification-and-authentication-failures">IDENTIFICATION AND AUTHENTICATION FAILURES</h3><p>Weak authentication mechanisms can allow unauthorized access to the application.</p><p>Example:</p><p>Using a hardcoded password for authentication.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">authenticate</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">,</span> <span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"password123"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">password</span><span class="o">);</span>  <span class="c1">// Hardcoded, weak password</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Hardcoded passwords are easily guessable and cannot be changed dynamically.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">authenticate</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">,</span> <span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">hashedPassword</span> <span class="o">=</span> <span class="n">fetchPasswordFromDatabase</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>
    <span class="k">return</span> <span class="nc">BCrypt</span><span class="o">.</span><span class="na">checkpw</span><span class="o">(</span><span class="n">password</span><span class="o">,</span> <span class="n">hashedPassword</span><span class="o">);</span>  <span class="c1">// Using strong hashing</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Best Practices:</p><ul><li>Enforce strong password policies.<li>Use multi-factor authentication (MFA) for sensitive actions. Avoid hardcoding sensitive data.</ul><h3 id="software-and-data-integrity-failures">SOFTWARE AND DATA INTEGRITY FAILURES</h3><p>Allowing unverified data (like updates) opens up the risk of malicious content.</p><p>Example:</p><p>Downloading files from untrusted sources without verification.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">downloadFile</span><span class="o">(</span><span class="nc">String</span> <span class="n">url</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="no">URL</span> <span class="n">downloadUrl</span> <span class="o">=</span> <span class="k">new</span> <span class="no">URL</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
    <span class="k">try</span> <span class="o">(</span><span class="nc">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">downloadUrl</span><span class="o">.</span><span class="na">openStream</span><span class="o">())</span> <span class="o">{</span>
        <span class="nc">Files</span><span class="o">.</span><span class="na">copy</span><span class="o">(</span><span class="n">in</span><span class="o">,</span> <span class="nc">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"downloaded-file.zip"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>The server may download and run malicious files from unverified sources.</p><p>Best Practices:</p><ul><li>Verify sources before downloading and executing files.<li>Use signed code and validate checksums for data integrity.</ul><h3 id="security-logging-and-monitoring-failures">SECURITY LOGGING AND MONITORING FAILURES</h3><p>Insufficient logging and monitoring allow attacks to go undetected.</p><p>Example:</p><p>Not logging failed login attempts.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">login</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">,</span> <span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">authenticate</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">))</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Login successful."</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>No logging makes it hard to detect brute force attempts or suspicious behavior.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">login</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">,</span> <span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">authenticate</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">))</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Login successful."</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Login failed for user: "</span> <span class="o">+</span> <span class="n">username</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Best Practices:</p><ul><li>Log important security events.<li>Regularly review logs and use alerting for suspicious activity.</ul><h3 id="server-side-request-forgery-ssrf">SERVER-SIDE REQUEST FORGERY (SSRF)</h3><p>SSRF vulnerabilities occur when an application lets users provide URLs or addresses to which the server will make requests without validating them. This can lead to unauthorized access to internal services or sensitive data exposure.</p><p>Example:</p><p>Allowing users to fetch data from any URL without verifying if the target is trusted or necessary.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">fetchData</span><span class="o">(</span><span class="nc">String</span> <span class="n">url</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="no">URL</span> <span class="n">target</span> <span class="o">=</span> <span class="k">new</span> <span class="no">URL</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
    <span class="k">try</span> <span class="o">(</span><span class="nc">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="na">openStream</span><span class="o">())</span> <span class="o">{</span>
        <span class="c1">// Process data</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Attackers can specify internal or protected endpoints to gather information or cause unintended effects. Without validation, the server could end up making requests to internal or even harmful services.</p><p>Validate URLs to ensure requests only go to trusted external servers.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">fetchData</span><span class="o">(</span><span class="nc">String</span> <span class="n">url</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="c1">// Allowing only trusted domains</span>
    <span class="k">if</span> <span class="o">(!</span><span class="n">url</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"https://trusted-domain.com"</span><span class="o">))</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">SecurityException</span><span class="o">(</span><span class="s">"Untrusted URL blocked"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="no">URL</span> <span class="n">target</span> <span class="o">=</span> <span class="k">new</span> <span class="no">URL</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
    <span class="k">try</span> <span class="o">(</span><span class="nc">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="na">openStream</span><span class="o">())</span> <span class="o">{</span>
        <span class="c1">// Process data securely</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Best Practices:</p><ul><li>Validate and restrict URLs to a set of trusted domains or patterns.<li>Block requests to internal IP addresses, localhost, or sensitive endpoints.<li>Use allow-lists and network-level controls where possible to limit where requests can go.</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/clean-code/'>clean_code</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/java/" class="post-tag no-text-decoration" >java</a> <a href="/tags/theory/" class="post-tag no-text-decoration" >theory</a> <a href="/tags/important/" class="post-tag no-text-decoration" >important</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Secure Coding in Java - OWASP TOP 10 - Gaurav's GitHub Page&url=https://gkgaurav31.github.io/posts/secure-coding-in-java/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Secure Coding in Java - OWASP TOP 10 - Gaurav's GitHub Page&u=https://gkgaurav31.github.io/posts/secure-coding-in-java/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Secure Coding in Java - OWASP TOP 10 - Gaurav's GitHub Page&url=https://gkgaurav31.github.io/posts/secure-coding-in-java/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://gkgaurav31.github.io/posts/secure-coding-in-java/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/amount-of-time-for-binary-tree-to-be-infected/">Amount of Time for Binary Tree to Be Infected</a><li><a href="/posts/cross-site-scripting-xss/">Cross-Site Scripting (XSS)</a><li><a href="/posts/find-the-celebrity/">Find the Celebrity</a><li><a href="/posts/find-the-element-that-appears-once-in-sorted-array/">Find the element that appears once in sorted array (geeksforgeeks - SDE Sheet)</a><li><a href="/posts/find-all-pairs-with-a-given-sum-geeksforgeeks-sde-sheet/">Find all pairs with a given sum (geeksforgeeks - SDE Sheet)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/geeksforgeeks/">geeksforgeeks</a> <a class="post-tag" href="/tags/important/">important</a> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/sde-sheet/">sde-sheet</a> <a class="post-tag" href="/tags/arrays/">arrays</a> <a class="post-tag" href="/tags/neetcode150/">neetcode150</a> <a class="post-tag" href="/tags/binarytree/">binarytree</a> <a class="post-tag" href="/tags/dynamic-programming/">dynamic_programming</a> <a class="post-tag" href="/tags/interviewbit/">interviewbit</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/circular-tour/"><div class="card-body"> <span class="timeago small" > Oct 21, 2024 <i class="unloaded">2024-10-21T21:31:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Circular tour (geeksforgeeks - SDE Sheet)</h3><div class="text-muted small"><p> PROBLEM DESCRIPTION Suppose there is a circle. There are N petrol pumps on that circle. You will be given two sets of data. The amount of petrol that every petrol pump has. Distance from tha...</p></div></div></a></div><div class="card"> <a href="/posts/palindrome-linked-list/"><div class="card-body"> <span class="timeago small" > Sep 14, 2024 <i class="unloaded">2024-09-14T14:44:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Palindrome Linked List (geeksforgeeks - SDE Sheet)</h3><div class="text-muted small"><p> PROBLEM DESCRIPTION Given a singly linked list of integers. The task is to check if the given linked list is palindrome or not. geeksforgeeks SOLUTION To solve this, we can reverse the second h...</p></div></div></a></div><div class="card"> <a href="/posts/flattening-a-linked-list/"><div class="card-body"> <span class="timeago small" > Sep 14, 2024 <i class="unloaded">2024-09-14T18:33:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Flattening a Linked List (geeksforgeeks - SDE Sheet)</h3><div class="text-muted small"><p> PROBLEM DESCRIPTION Given a Linked List, where every node represents a sub-linked-list and contains two pointers: (i) a next pointer to the next node, (ii) a bottom pointer to a linked list where ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/security-tools/" class="btn btn-outline-primary" prompt="Older"><p>Security Tools</p></a> <a href="/posts/secure-coding-in-c-and-c-part-2/" class="btn btn-outline-primary" prompt="Newer"><p>Secure Coding in C and C++ (Part 2)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/gkgaurav31">Gaurav Kumar</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/geeksforgeeks/">geeksforgeeks</a> <a class="post-tag" href="/tags/important/">important</a> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/sde-sheet/">sde sheet</a> <a class="post-tag" href="/tags/arrays/">arrays</a> <a class="post-tag" href="/tags/neetcode150/">neetcode150</a> <a class="post-tag" href="/tags/binarytree/">binarytree</a> <a class="post-tag" href="/tags/dynamic-programming/">dynamic_programming</a> <a class="post-tag" href="/tags/interviewbit/">interviewbit</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://gkgaurav31.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
